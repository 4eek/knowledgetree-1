if(typeof kt.app=="undefined")kt.app={};if(typeof kt.api=="undefined")kt.api={};
kt.app.sharewithusers=new function(){var e=this.fragmentPackage=[this.fragments=["users/invite.shared.dialog"]],f=this.execPackage=[this.execs=["users/invite.shared.confirm.dialog"]],c=this;this.elems={};this.init=function(){kt.api.preload(e,f,true)};this.inviteWindow=null;this.inviteUsers=function(b){emails=document.getElementById("share.emails").value;if(emails.length<3)alert("Please enter a valid email address.");else{var a=[];readOnly=jQuery("#readonly:checkbox:checked").val();perm=readOnly===
undefined?1:0;a.permission=perm;a.object_id=document.getElementById("object.id").value;a.object_type=document.getElementById("object.type").value;a.message=document.getElementById("share.message").value;kt.api.shareUsers(emails,b,a,c.inviteCallback,function(){})}c.disableInviteButton()};this.inviteCallback=function(b){b=jQuery.parseJSON(b.data.invitedUsers).invited;var a=new Ext.Window({id:"extinviteconfirmwindow",layout:"fit",width:400,resizable:false,closable:true,closeAction:"destroy",y:50,autoScroll:false,
bodyCssClass:"ul_win_body",cls:"ul_win",shadow:true,modal:true,title:"Content Shared",html:kt.api.execFragment("users/invite.shared.confirm.dialog")});c.closeWindow();c.inviteConfirmWin=a;a.show();document.getElementById("sharedUsers").innerHTML=b};this.enableInviteButton=function(){jQuery("#invite_actions_invite_btn").removeAttr("disabled")};this.disableInviteButton=function(){jQuery("#invite_actions_invite_btn").attr("disabled","true")};this.shareContentWindow=function(b,a,d,g){d=new Ext.Window({id:"extinvitewindow",
layout:"fit",width:440,resizable:false,closable:true,closeAction:"destroy",y:50,autoScroll:false,bodyCssClass:"ul_win_body",cls:"ul_win",shadow:true,modal:true,title:"Sharing",html:kt.api.getFragment("users/invite.shared.dialog")});c.inviteWindow=d;d.show();if(b!=null&&a!=null){document.getElementById("object.id").value=b;document.getElementById("object.type").value=a}if(g==0){jQuery("#readonly").attr("checked","true");jQuery("#readonly").attr("disabled","disabled")}c.disableInviteButton()};this.closeWindow=
function(){inviteWindow=Ext.getCmp("extinvitewindow");inviteWindow.destroy()};this.closeConfirmWindow=function(){inviteConfirmWin=Ext.getCmp("extinviteconfirmwindow");inviteConfirmWin.destroy()};this.init()};
