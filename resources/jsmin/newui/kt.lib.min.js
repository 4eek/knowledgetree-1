kt.lib.String=new function(){this.parse=function(c,b){ret=new String(c);if(typeof b=="object")for(var a in b)for(var e="["+a+"]";ret.indexOf(e,0)>=0;)ret=ret.replace(e,b[a]);return ret}};
kt.lib.Object=new function(){try{this.extend=function(b,a,e){try{if(typeof b!=="object")b={};if(typeof a!=="object")a={};e=e?true:false;for(var f in a)if(e?a.hasOwnProperty(f):1)b[f]=a[f];return b}catch(d){kt.evt.triggerErrorLog("kt.lib.Object.extend",d)}};this.boundFunction=function(b,a){try{if(typeof a!=="function")a=b[""+a];return function(f,d){d.apply(f,arguments)}(b,a)}catch(e){kt.evt.triggerErrorLog("kt.lib.Object.boundFunction",e)}}}catch(c){kt.evt.triggerErrorLog("kt.lib.Object",c)}this.is_object=
function(b){return b instanceof Array?false:b!==null&&typeof b=="object"};this.ktenum=function(b,a,e){a=(""+a).split(",");for(var f in a)if(b==a[f])return b;return e}};
kt.lib.shortcut={all_shortcuts:{},add:function(c,b,a){var e={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(a)for(var f in e){if(typeof a[f]=="undefined")a[f]=e[f]}else a=e;e=a.target;if(typeof a.target=="string")e=document.getElementById(a.target);c=c.toLowerCase();f=function(d){d=d||window.event;if(a.disable_in_input){var h;if(d.target)h=d.target;else if(d.srcElement)h=d.srcElement;if(h.nodeType==3)h=h.parentNode;if(h.tagName=="INPUT"||h.tagName=="TEXTAREA")return}if(d.keyCode)code=
d.keyCode;else if(d.which)code=d.which;h=String.fromCharCode(code).toLowerCase();if(code==188)h=",";if(code==190)h=".";var j=c.split("+"),i=0,m={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},n={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,
home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},g={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(d.ctrlKey)g.ctrl.pressed=true;if(d.shiftKey)g.shift.pressed=true;if(d.altKey)g.alt.pressed=true;if(d.metaKey)g.meta.pressed=true;for(var l=0;k=j[l],l<j.length;l++)if(k==
"ctrl"||k=="control"){i++;g.ctrl.wanted=true}else if(k=="shift"){i++;g.shift.wanted=true}else if(k=="alt"){i++;g.alt.wanted=true}else if(k=="meta"){i++;g.meta.wanted=true}else if(k.length>1)n[k]==code&&i++;else if(a.keycode)a.keycode==code&&i++;else if(h==k)i++;else if(m[h]&&d.shiftKey){h=m[h];h==k&&i++}if(i==j.length&&g.ctrl.pressed==g.ctrl.wanted&&g.shift.pressed==g.shift.wanted&&g.alt.pressed==g.alt.wanted&&g.meta.pressed==g.meta.wanted){b(d);if(!a.propagate){d.cancelBubble=true;d.returnValue=
false;if(d.stopPropagation){d.stopPropagation();d.preventDefault()}return false}}};this.all_shortcuts[c]={callback:f,target:e,event:a.type};if(e.addEventListener)e.addEventListener(a.type,f,false);else if(e.attachEvent)e.attachEvent("on"+a.type,f);else e["on"+a.type]=f},remove:function(c){c=c.toLowerCase();var b=this.all_shortcuts[c];delete this.all_shortcuts[c];if(b){c=b.event;var a=b.target;b=b.callback;if(a.detachEvent)a.detachEvent("on"+c,b);else if(a.removeEventListener)a.removeEventListener(c,
b,false);else a["on"+c]=false}}};
kt.lib.meta=new function(){this.data={};this.set=function(c,b,a){this.data[this.initElem(c)][b]=a};this.get=function(c,b){var a=this.data[this.initElem(c)][b];return typeof a=="undefined"?null:a};this.initElem=function(c){if(typeof c.id=="undefined")c.id=this.uniqid();if(c.id=="")c.id=this.uniqid();if(typeof this.data[c.id]=="undefined")this.data[c.id]={};return c.id};this.uniqid=function(){for(var c="meta_",b=0;b<16;b++)c=c+""+"abcdefghijklmnopqrstuvwxyz1234567890_"[Math.floor(Math.random()*37)];
if(document.getElementById(c)!=null)return this.uniqid();return c}};
