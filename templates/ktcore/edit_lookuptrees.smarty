{literal}
<style>

.kt_treenodes {
    list-style: none;
    margin: 0;
    padding: 0;
    border: 0;
}

.leafnode {font-weight: bold; }

.kt_treenodes ul {
    list-style: none;
}
.kt_treenodes li.treenode > a.pathnode {
   background: transparent url(/graphics/plus.png) center left no-repeat;
   padding-left: 15px;
}

.kt_treenodes li.treenode.active > a.pathnode {
   background: transparent url(/graphics/minus.png) center left no-repeat;
}

.kt_treenodes li.active > ul {
    display: block;
}

.kt_treenodes li ul {
    display: none;
}

</style>
{/literal}

{$context->oPage->requireJSResource('thirdpartyjs/MochiKit/Base.js')}
{$context->oPage->requireJSResource("thirdpartyjs/MochiKit/Iter.js")}
{$context->oPage->requireJSResource("thirdpartyjs/MochiKit/DOM.js")}

<h2>Edit Lookup Tree: {$field->getName()}</h2>


<form>
<fieldset>
  <legend>Add New Subcategory</legend>
  
  
  
  <input type="hidden" name="field_id" value="{$field->getId()}" />
  <input type="hidden" name="action" value="editTree" /> 
  <input type="hidden" name="subaction" value="addCategory" />
  <input type="hidden" name="current_node" value="{$currentNode}" />

<input type="text" name="category_name"/>

<div class="form_actions">
  <input type="submit" name="submit" value="add new category" />
</div>
</fieldset>
</form>
{if ($currentNode != 0)}
{if (empty($freechildren))}
<p>No free keywords.  Use the "unlink" action on a keyword to 
make it available.</p>
{else}
<form>
<fieldset>
  <legend>Link free keywords.</legend>
  
<p>Category: <strong>{if ($currentNode == 0)}
Root
{else}
{$tree->mapnodes[$currentNode]->getName()}
{/if}</strong></p>  
  
  <input type="hidden" name="field_id" value="{$field->getId()}" />
  <input type="hidden" name="action" value="editTree" /> 
  <input type="hidden" name="subaction" value="linkKeywords" />
  <input type="hidden" name="current_node" value="{$currentNode}" />



<select multiple="1" name="keywordsToAdd[]">
    {foreach item=oKeyword from=$freechildren}
       <option value="{$oKeyword->getId()}">{$oKeyword->getName()}</option>
    {/foreach}
</select>

<div class="form_actions">
  <input type="submit" name="submit" value="Add to category" />
</div>
</fieldset>
</form>
{/if}
{/if}


<h2>Preview</h2>
<div class="helpText">
    Use the +/- arrows to open or close the tree.  Bold items are metadata keywords.
    To edit a category (including adding or removing keywords) click on the "edit" link.
</div>

{$renderedTree}
